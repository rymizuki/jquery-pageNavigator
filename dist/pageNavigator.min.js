/*! pageNavigator - v0.0.8 - 2013-12-18
* https://github.com/mizuki/jquery-page-navigator
* Copyright (c) 2013 mizuki_r; Licensed MIT */
var PageNavigator=function(a){"use strict";var b=function(c,d){this.$el=c instanceof a?c:a(c),this.el=this.$el.get(0),this.opts=d,this.pager=new b.Pager({total_entries:this.$el.attr("data-total-entries")||d.total_entries,entries_per_page:this.$el.attr("data-entries-per-page")||d.entries_per_page,current_page:this.$el.attr("data-current-page")||d.current_page}),this.controls=new b.controls[d.extension](this.$el,this.pager,this.opts.controls),this.opts.is_render_controls&&this.render()};return b.prototype.render=function(){this.controls.render(),this.$el.trigger("pn:navigate",[this,this.pager.currPage()])},b.prototype.navigate=function(a){this.pager.setCurrPage(a),this.controls.navigate(),this.$el.trigger("pn:navigate",[this,a])},b.prototype.next=function(){return this.pager.nextPage()?(this.navgate(this.pager.nextPage()),void 0):null},b.prototype.prev=function(){return this.pager.prevPage()?(this.navgate(this.pager.prevPage()),void 0):null},b}(jQuery);PageNavigator.controls={},PageNavigator.util=function(a){"use strict";var b=function(a){var b={};return a=a.replace(/^\?/,""),a.split("&").forEach(function(a){if(a.match(/=/)){var c=a.split("=");b[c[0]]=c[1]}}),b},c=function(a){var b=[];for(var c in a)b.push(c+"="+a[c]);return b.join("&")},d=function(a){var b={};for(var c in a)b[encodeURIComponent(c)]=encodeURIComponent(a[c]);return b},e=function(e){var f=b(location.search);return a.extend(f,d(e)),location.pathname+"?"+c(f)};return{uri_with:e}}(jQuery),PageNavigator.Pager=function(){"use strict";var a=function(a){this.has_next=void 0,this.total_entries=Number(a.total_entries),this.entries_per_page=Number(a.entries_per_page),this.current_page=Number(a.current_page),a.has_next&&(this.has_next=!!Number(a.has_next))};return a.prototype.setCurrPage=function(a,b){var c=Number(a);this.current_page=c,this.has_next=void 0===b?b:void 0},a.prototype.hasNext=function(a){return void 0!==a&&(this.has_next=!!a),void 0===this.has_next&&(this.has_next=this.currPage()<this.lastPage()?!0:!1),this.has_next},a.prototype.currPage=function(){return this.current_page},a.prototype.prevPage=function(){return this.currPage()>1?this.currPage()-1:null},a.prototype.nextPage=function(){return this.hasNext()?this.currPage()+1:null},a.prototype.firstPage=function(){return 1},a.prototype.lastPage=function(){if(this.total_entries<1)return 1;var a=this.total_entries/this.entries_per_page;return a===parseInt(a,10)?a:parseInt(a,10)+1},a}(),PageNavigator.controls.Simple=function(a,b){"use strict";var c=function(a,c,d){this.$el=a,this.pager=c,this.classes=d.classes,this.uri_with=d.uri_with||b.uri_with,this.prev_text=d.prev_text,this.next_text=d.next_text};return c.prototype.render=function(){var b=a("<ul>").addClass(this.classes).append(this.renderPrev()).append(this.renderCurr()).append(this.renderNext());this.$el.html(b),this.pager.prevPage()||this.disabled("prev"),this.pager.nextPage()||this.disabled("next")},c.prototype.disabled=function(a){var b=this.$el.find(".pager-"+a);b.addClass("disabled"),b.attr("href",null)},c.prototype.navigate=function(){this.render()},c.prototype.makeControl=function(b,c){return a("<li/>").append(a("<a>").attr(c).text(b))},c.prototype.renderCurr=function(){return this.makeControl(this.pager.currPage(),{"class":"pager-curr",href:this.uri_with({page:this.pager.currPage()})})},c.prototype.renderPrev=function(){return this.makeControl(this.prev_text,{"class":"pager-prev",href:this.uri_with({page:this.pager.prevPage()})})},c.prototype.renderNext=function(){return this.makeControl(this.next_text,{"class":"pager-next",href:this.uri_with({page:this.pager.nextPage()})})},c}(jQuery,PageNavigator.util),PageNavigator.controls.Numbering=function(a,b,c){"use strict";var d=function(a,b,d){c.apply(this,[a,b,d]),this.link_num_step=d.number_step||2};return d.prototype=Object.create(c.prototype),d.prototype.constructor=c,d.prototype.renderCurr=function(){for(var a=this.calcLabelPeriod(),b=a[0],c=a[1],d=[],e=b;c>=e;e++){var f="pager-label";this.pager.currPage()===e&&(f+=" active"),d.push(this.makeControl(e,{"class":f,href:this.uri_with({page:e})}))}return b>this.pager.firstPage()&&(b>this.pager.firstPage()+this.link_num_step&&d.unshift(this.makeControl("...",{"class":"pager-divider disabled"})),d.unshift(this.makeControl(this.pager.firstPage(),{"class":"pager-label",href:this.uri_with({page:this.pager.firstPage()})}))),c<this.pager.lastPage()&&(c<this.pager.lastPage()-this.link_num_step&&d.push(this.makeControl("...",{"class":"pager-divider disabled"})),d.push(this.makeControl(this.pager.lastPage(),{"class":"pager-label",href:this.uri_with({page:this.pager.lastPage()})}))),d},d.prototype.calcLabelPeriod=function(){var a=this.pager.currPage()-this.link_num_step,b=this.pager.currPage()+this.link_num_step,c=this.pager.firstPage(),d=this.pager.lastPage();return this.validLowerLimit(a)?this.validUpperLimit(b)||(a-=b-d,this.validLowerLimit(a)||(a=c),b=d):(b=b+-1*a+1,this.validUpperLimit(b)||(b=d),a=c),[a,b]},d.prototype.validUpperLimit=function(a){return a<=this.pager.lastPage()?!0:!1},d.prototype.validLowerLimit=function(a){return a>=this.pager.firstPage()?!0:!1},d}(jQuery,PageNavigator.util,PageNavigator.controls.Simple),function(a){"use strict";a.fn.pageNavigator=function(b,c){var d;return"object"==typeof b?(d=b,b=null):d=c||{},this.each(function(){var c=a(this),e=c.data("page-navigator.data-api");e||(e=a.pageNavigator(c,d),c.data("page-navigator.data-api",e)),b&&"string"==typeof b&&e[b]()})},a.pageNavigator=function(b,c){return c=a.extend({},a.pageNavigator.options,c),new PageNavigator(b,c)},a.pageNavigator.options={is_render_controls:!0,extension:"Simple",controls:{classes:null,uri_with:null,prev_text:"prev",next_text:"next"}}}(jQuery);