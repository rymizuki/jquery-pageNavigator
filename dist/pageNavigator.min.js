/*! pageNavigator - v0.0.2 - 2013-12-06
* https://github.com/mizuki/jquery-page-navigator
* Copyright (c) 2013 mizuki_r; Licensed MIT */
!function(a){var b=function(a){var b={};return a=a.replace(/^\?/,""),a.split("&").forEach(function(a){if(a.match(/=/)){var c=a.split("=");b[c[0]]=c[1]}}),b},c=function(a){var b=[];for(var c in a)b.push(c+"="+a[c]);return b.join("&")},d=function(a){var b={};for(var c in a)b[encodeURIComponent(c)]=encodeURIComponent(a[c]);return b},e=function(e){var f=b(location.search);return a.extend(f,d(e)),location.pathname+"?"+c(f)},f=function(){var b=function(a,b,c){this.$el=a,this.pager=b,this.class=c.class,this.prev_text=c.prev_text,this.next_text=c.next_text};return b.prototype.render=function(){var b=a("<ul>").addClass(this.class).append(this.renderPrev()).append(this.renderCurr()).append(this.renderNext());this.$el.html(b),this.pager.prevPage()||this.disabled("prev"),this.pager.nextPage()||this.disabled("next")},b.prototype.disabled=function(a){var b=this.$el.find(".pager-"+a);b.addClass("disabled"),b.attr("href",null)},b.prototype.navigate=function(){this.render()},b.prototype.makeControl=function(b,c){return a("<li/>").append(a("<a>").attr(c).text(b))},b.prototype.renderCurr=function(){return this.makeControl(this.pager.currPage(),{"class":"pager-curr",href:e({page:this.pager.currPage()})})},b.prototype.renderPrev=function(){return this.makeControl(this.prev_text,{"class":"pager-prev",href:e({page:this.pager.prevPage()})})},b.prototype.renderNext=function(){return this.makeControl(this.next_text,{"class":"pager-next",href:e({page:this.pager.nextPage()})})},b}(),g=function(){var a=function(a){this.has_next=void 0,this.total_entries=Number(a.total_entries),this.entries_per_page=Number(a.entries_per_page),this.current_page=Number(a.current_page),a.has_next&&(this.has_next=!!Number(a.has_next))};return a.prototype.setCurrPage=function(a,b){var c=Number(a);this.current_page=c,this.has_next=void 0===b?b:void 0},a.prototype.hasNext=function(a){return void 0!==a&&(this.has_next=!!a),void 0===this.has_next&&(this.has_next=this.currPage()<this.lastPage()?!0:!1),this.has_next},a.prototype.currPage=function(){return this.current_page},a.prototype.prevPage=function(){return this.currPage()>1?this.currPage()-1:null},a.prototype.nextPage=function(){return this.hasNext()?this.currPage()+1:null},a.prototype.lastPage=function(){if(this.total_entries<1)return 1;var a=this.total_entries/this.entries_per_page;return a===parseInt(a,10)?a:parseInt(a,10)+1},a}(),h=function(a){var b=function(b,c){this.$el=b instanceof a?b:a(b),this.el=this.$el.get(0),this.opts=c,this.pager=new g({total_entries:c.total_entries,entries_per_page:c.entries_per_page,current_page:c.current_page}),this.controls=new f(this.$el,this.pager,this.opts.controls),this.opts.is_render_controls&&this.render()};return b.prototype.render=function(){this.controls.render(),this.$el.trigger("pn:navigate",[this,this.pager.currPage()])},b.prototype.navigate=function(a){this.pager.setCurrPage(a),this.controls.navigate(),this.$el.trigger("pn:navigate",[this,a])},b.prototype.next=function(){return this.pager.nextPage()?(this.navgate(this.pager.nextPage()),void 0):null},b.prototype.prev=function(){return this.pager.prevPage()?(this.navgate(this.pager.prevPage()),void 0):null},b}(a);a.fn.pageNavigator=function(b,c){return this.each(function(){var d=a(this),e=d.data("page-navigator"),f="object"==typeof b?b:c||{};e||(e=a.pageNavigator(d,f),d.data("page-navigator",e)),b&&"string"==typeof b&&e[b]()})},a.pageNavigator=function(b,c){return c=a.extend({},a.pageNavigator.options,c),new h(b,c)},a.pageNavigator.options={is_render_controls:!0,controls:{"class":null,prev_text:"prev",next_text:"next"}}}(jQuery);